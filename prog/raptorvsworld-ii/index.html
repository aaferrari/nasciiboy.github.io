<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Raptor VS Mundo</title>
    <link href="" rel="alternate" title="⋲ᴹ∧cₛ ℜø∁κ§" type="application/atom+xml">
    <style>:root {

    --BGC      : #000000;
    --FGC      : #ffffff;
    --BGClogo  : #222222;
    --FGClogo  : #ffffff;
    --FGCtitle : #ff4500;
    --FGCstart1: #4B99D2;
    --FGCstart2: #00ffff;
    --FGCstart3: #ffa074;
    --FGCstart4: #98fb98;
    --FGCstart5: #b0c4de;
    --FGCstart6: #7fffd4;
    --FGCstart7: #db2e24;
    --FGCstart8: #ff4500;
    --FGCtext  : #ffffff;
    --FGCemph  : #ffffff;
    --FGCbtcode: #333333;
    --FGCftcode: #ffffff;
    --FGCbcode : #b3b3b3;
    --FGCtcomm : #ff4500;
    --FGCtcode : #bfbfff;
    --FGCfile  : #eedd82;
    --FGCmath  : #98fb98;
    --FGClink  : #00ffff;
    --BGClinkh : #556b2f;
    --FGClinkh : #ffffff;
    --BGCdt    : #b3b3b3;
    --FGCdt    : #ffffff;
    --FGCthead : #ff7f24;
    --BGCthead : #000000;
    --FGCtbody : #87cefa;
}

@font-face { font-family: text;           src: local('sans-serif'          );                     }
@font-face { font-family: text_bold;      src: local('sans-serif'   ); font-style: bold;   }
@font-face { font-family: text_italic;    src: local('sans-serif'   ); font-style: italic; }
@font-face { font-family: text_verse;     src: local('sans-serif'   ); font-style: italic; }
@font-face { font-family: title;          src: local('cursive'      );                     }
@font-face { font-family: heatline;       src: local('cursive'      );                     }
@font-face { font-family: codetext;       src: url('https://www.nasciiboy.land/DejaVuSansMono.ttf'); }
@font-face { font-family: codeblock;      src: url('https://www.nasciiboy.land/DejaVuSansMono.ttf'); }
@font-face { font-family: description_dt; src: local('cursive'      );                     }
@font-face { font-family: description_dd; src: local('sans'         );                     }

html { background: var( --BGC ); color: var( --FGC );
       margin: 0; padding: 0;
       font-size: 1.3em;
       line-height: 1.5em;
       box-sizing: border-box;
     }

html body { margin: 1em 0em 1em 1em;
            font-size: 1.0em;
            font-family: text;
          }

html body main {font-size: 1.0em;
                font-family: text;
                box-sizing:border-box;
                padding: 1em 1em 1em 1.5em
                ;
                width: 70%;
                float: left;
               }

html body main article { padding-right: 1em; }

html body main div.thumb {font-size: 1.0em;
                font-family: text;
                box-sizing: border-box;
                padding: 1em;
                width: 48%;
                float: left;
               }

ul.meta { list-style: none; padding-left: 0.8em; margin: 0em; }
ul.meta li { line-height: 1.5em; }

.taxonomies { color: green; clear: both; }

.summary {
  max-height: 8.7rem;
  overflow: hidden;
}

div.thumb-sm {font-size: 0.7em;
                font-family: text;
             }

.thumb-sm header h2 { margin: 0em; padding: 0.3em 0em 0em 0em; }

html body aside {
    font-size: 1.0em;
    font-family: text;
    box-sizing:border-box;
    width: 30%;
    float: left;
    padding-left: 1em;
}

header.key { color: black; }

aside div ul { padding-left: 0em; margin: 0em; }

html body footer {
    font-size: 0.7em;
    clear: both;
}

nav.p-paging { clear: both; padding-top: 2em; text-align: center; }

.footer-title { clear: both; }

.footer-title a { list-style: none; text-decoration: none; color: red; }

h1 { color: var( --FGCtitle  ); font-size:   3em; font-family: title   ; line-height: 1.1em; }
h2 { color: var( --FGCstart1 ); font-size: 1.6em; font-family: heatline; line-height: 1.1em; }
h3 { color: var( --FGCstart2 ); font-size: 1.5em; font-family: heatline; line-height: 1.1em; }
h4 { color: var( --FGCstart3 ); font-size: 1.4em; font-family: heatline; line-height: 1.1em; }
h5 { color: var( --FGCstart4 ); font-size: 1.3em; font-family: heatline; line-height: 1.1em; }
h6 { color: var( --FGCstart5 ); font-size: 1.2em; font-family: heatline; line-height: 1.1em; }
h7 { color: var( --FGCstart6 ); font-size: 1.1em; font-family: heatline; line-height: 1.1em; }
h8 { color: var( --FGCstart7 ); font-size: 1.1em; font-family: heatline; line-height: 1.1em; }
h9 { color: var( --FGCstart8 ); font-size: 1.1em; font-family: heatline; line-height: 1.1em; }

.path li { display: inline; list-style:none; padding: 0em 0.1em; margin:0em; }
.path li a { text-decoration: none; color: #87cefa; }
.path-pwd { color: yellow; }

pre {
    background-color: var( --FGCbtcode ); color: white;
    font-size: 1em; text-align: left; font-family: codeblock;
    box-sizing:border-box; padding: 1.0em; border: 0.05em solid #ddd;
    overflow: auto;
}

pre code { background-color: var( --FGCbtcode );
           color: var( --FGCftcode );
           font-size: 1em;  font-family: codetext;
           padding: 0em;
}

ul.nav { list-style-type: none; }
ul.nav li { display: inline-block; list-style: none; }
ul.nav li a { color: white; background-color: black; text-decoration: none; padding: 0.5em .5em; border: 3px solid white; }
ul.nav li a:hover { color: #ea316e; background-color: white; text-decoration: none; padding: 0.2em .5em; border-radius: 1em; }


b    { font-family: text_bold; }
i    { font-family: text_italic; }
u    { text-decoration: underline; }
em   { color: var( --FGCemph ); font-weight: 600; }
code { color: var( --FGCtcode ); font-family: codetext; padding: 0px 0.2em; }
code.command { color: var( --FGCtcomm ); font-family: codetext; padding: 0px 0.2em; }
.file { color: var( --FGCfile ); font-family: codetext; }
.math { color: var( --FGCmath ); font-family: codetext; }
blockquote { color: #F99; }


a { color: #00ffff; text-decoration: underline; }
a:hover { background-color: #556b2f; color: #ffffff; text-decoration: none; }

li { color: #fff; font-size: 1em; }
li b { font-weight: bold; }
li p { color: #fff; font-size: 1em; }


dl { padding-bottom: 2em; }
dl dt { color: #daa520;
                                  font-size: 1.2em; font-family: description_dt;
                                  margin-left: 0.6em; }
dd { color: #ffffff;
                                  font-size: 1.0em; font-family: description_dd; font-style: bold;
                                  margin-left: 0.6em; }
img { border: none; max-width: 100%;
    }
img:hover { border: 0.05em solid #fff; }

.clear  { clear: both; }
.center { display: flex;
          justify-content: center;
        }
.previous { float: left; }
.next { float: right; }

/* #### Dark Matter #### */
.dark-matter {
    margin-left: auto;
    margin-right: auto;
    font: .3em "Helvetica Neue", Helvetica, Arial, sans-serif;
    border: none;
}
.dark-matter h1 {
    display: block;
    border-bottom: 1px solid #444;
    padding: 1em;
}
.dark-matter h1>span {
    display: block;
    font-size: .7em;
}
.dark-matter label {
    display: block;
}
.dark-matter label>span {
    float: left;
    width: 15%;
    text-align: right;
    padding-right: 2em;
    margin-top: 1.5em;
    font-weight: bold;
}
.dark-matter input[type="text"],
.dark-matter input[type="email"],
.dark-matter textarea {
    border: none;
    color: #525252;
    margin: .5em;
    padding:.3em;
    width: 70%;
    background: #DFDFDF;
}

.submit {
    background: #222;
    color: white;
    margin-top: .7em;
    padding: .5em 1.5em;
}

.submit:hover {
    color: green;
}
</style>
  </head>
  <body>
    
<main>
  <div class="clear" ><a href="https://www.nasciiboy.land">/</a></span> <span><a href="https://www.nasciiboy.land/prog">prog</a></div>

  <h1>Raptor VS Mundo</h1>
  

<p>(Ya que la forma en que presenta github los readme&rsquo;s no es apropiada para una
extensa tabla, he agregado la comparativa como una pagina (oculta e
independentista) del blog: <a href="https://nasciiboy.land/raptorVSworld/">aqui</a>)</p>

<p>Hace tiempo que no actualizaba la <strong>&ldquo;Performance comparison of regular
expression engines&rdquo;</strong>, una prueba que tome prestada de <em>dark100</em> (nick de
sourceforge) so-pretexto de poner a prueba la version en Go de mi motor pueril
de expresiones regulares (alias Recursive Regexp Raptor), al cual profeso apego,
alegria y frustracion por el tiempo inmensurable que le he invertido.</p>

<p>Una cosa que me incomodaba del codigo preexistente, es que las pruebas estaban
centralizadas en un unico fichero en C que aglutinaba todos los motores y
pruebas, y al no tener C &ldquo;namespaces&rdquo;, tenia conflictos con la version 3 y 4 de
la libreria, ademas de limitar los lenguajes que podian participar en la prueba
solo a C y C++.</p>

<p><img src="https://www.nasciiboy.land/img/Computer-Guy.png" alt="" /></p>

<p>Como pues organizar el asunto para incluir las pruebas? deberian tener un
&ldquo;formato&rdquo; unificado para aceptar datos de entrada y entregar datos de salida de
igual forma, como la unica manera que conosco de enviar informacion a &ldquo;cosas&rdquo; (en
C, C++ y Go) es por medio de argumentos, pues eso hice, proponiendo la interfaz
generica para cada concursante asi:</p>

<pre><code>$ ./concursante sujeto-de-pruebas ciclos prueba-1 prueba-2 ... prueba-n
</code></pre>

<p>donde el <em>sujeto-de-pruebas</em> son los datos objeto de las pruebas, en este caso
y tratando de machacar a los motores de expresiones regulares, un archivo de
20MB de texto puro y duro en ascii con formato utf8 al estilo unix, es decir con
saltos <code>\n</code> que es la unica forma decente de indicar un salto de linea (que le
den por culo al resto de formatos de codificacion)</p>

<p>una vez echo esto, como demonios llamar e identificar las pruebas, te podras
preguntar, pues llamando a todas las pruebas <code>bin.syntaxis.concursante</code> con un script
de bash, me respondi. Donde <code>syntaxis</code> denota el estilo, pues esta la sintaxis
&ldquo;estandar&rdquo; de expresiones regulares (que es algo asi como el estilo perl
simplificado) y por el otro lado tenia <em>mi</em> sintaxis comoda con la que escribi
el raptor, ademas que, existia la posivilidad que algun motor incluido o a
incluir, tubiera su sintaxis propia.</p>

<p>Con bash, poco me he puesto, lo encontre lioso, limitado y lento, asi que
obtendria a los concursantes con un <code>ls</code> y luego haria un bucle sobre el
resultado pasando el nombre del archivo de pruebas, el numero de ciclos y las
pruebas en si. OohHH, como demonios pasar pruebas que tiene la sistaxis de
cadenas de C, con bash? respuesta corta luego varios intentos, pruebas y una
busqueda: <code>$'cadena-formateada-estilo-c'</code></p>

<p>Dudas tenia, acerca de como se enviaban internamente los parametros desde el
interprete, hasta el programa y como comunicarlos entre si. Por esta razon,
decidi en enviar solo el nombre del fichero sobre el cual efectuar las pruebas y
que cada programa se las arreglara para cargarlo, en lugar de enviar un
parametro de 20MB.</p>

<p>Segundo problema, como gestionar los resultados? la otra cosa que se hacer mas
en C y Go es escribir en ficheros, lo cuales se llamarian
<code>result.syntaxis.concursante</code>, siguiendo el estilo anterior, asi el programa que
se encargara de examinar los dator sabria quien y con que sintaxis se hizo cada
resultado. El fichero en si, esta formateado como lineas con el formato</p>

<pre><code>tiempo-en-ms coincidencias prueba
</code></pre>

<p>nada que explicar, solo la prueba, que es la exprecion aplicada, pero si esta
contiene saltos de lineas, tabuladores y otros signos raros no joderian el
resultado? Si, antes de escribir al fichero deben ser &ldquo;normalizarlos&rdquo;, je, que
ironico, el problema inverso a enviar los parametros&hellip;</p>

<p>Tercer dilema, Como compilar las pruebas? con otro script de bash que encuentra
y ejecuta los ficheros con el formato <code>compile.concursante.sh</code>, ya cada
&ldquo;compile&rdquo; sabra como hacer sus cosas para generar su binario. Por ejemplo, para
las librerias regex en C y C++, se limitar a invocar un makefile, y para los
programas en Go, van al archivo fuente, lo compilan con <code>go build</code> y mueven el
binario al directorio principal</p>

<p>El ultimo problema, Como gestionar la informacion resultante? pues leer cada
fichero <code>result.*</code>, cargar en un arreglo cada uno &ldquo;por lineas&rdquo;, optener una
muestra del las pruebas utilizadas por su sintaxis, comprobar que cada fichero
tiene el mismo numero de pruebas para &ldquo;emparejarlas&rdquo; e iterar por cada linea en
cada fichero mientras se construlle una tabla en html</p>

<p>optener un listado de ficheros en el directorio con bash, sencillo es, con C
complicado y no portable, con Go intermedio. Como para los ultimos 2 tendria que hacer una
seleccion adicional en busca de los nombres correspondientes a las prubas,
decidi enviar el nombre de las pruebas como parametros al programa encargado de
generar la tabla.</p>

<p>Bash que es practicamente un desconocido para mi, no era ni de cerca una
alternativa, utilizar awk era una posibilidad, pero solo me he puesto con el lo
suficiente para saber que podria hacerse. Luego intente con C, pero abandone
pronto&hellip; Cuanto daño hacen las comodidades modernas&hellip; en C nunca me acostumbre a
pedirle memoria al sistema y liberarla despues.</p>

<p>Asi que el encargado de analizar los resultados, escrito en Go esta y
el script en bash que ejecuta las pruebas le envia cuales son estos resultados</p>

<p>Un problema que deberia solucionar en proximas versiones, es advertir que el
resultado se coloca en un fichero llamado <code>table</code> si todo va bien, y que antes
de correr las pruebas se eliminan todas los ficheros <code>result.*</code>, por que cada
programa en C, se limita a agregar lineas al final de estos. Almenos un triste
<code>echo 'all ok, see &quot;table&quot;'</code> o un <code>cat</code> al resultado</p>

<p>comentar que cuando un motor no es capas de realizar una prueba, deberia colocar
como linea de resultado <code>&quot;---&quot;</code> y/o ser invocado con <code>&quot;---&quot;</code>, con el fin de
preservar la &ldquo;paridad&rdquo;</p>

<h2 id="extra">Extra</h2>

<p>Hu, nunca me senti bien, ni con bash, ni con make, aunque este ultimo es util,
conveniente y poderoso, sin llegar a ser lo criptico que es bash</p>

<p>En el camino, el reencuentro con C fue duro, olvide muchos <code>;</code>, parentesis y
formato para declara variables, aunque al final ya habia recupenado algo de
confiansa, pero no la suficiente como para programarme el analizador de los
resultados, me gustaria algun dia analizar esto en profundidad, aunque creo que
me quedare un largo periodo con Go, quiza regrese si en algun momento escribo un
manual para hacer videojuegos o en un lejano futuro agrego un lenguaje
customizado a la larga lista de lenguajes que compiten por la supremacia</p>

<p>aunque todos los participantes (en C) comparten una &ldquo;plantilla&rdquo; comun, hizo
falta un kilo mas de refinamiento, por ejemplo en el manejo de errores, aunque
casi todo esta solventado, en cambio en Go, pase por alto esto en la libreria
estandar de expresiones regulares, y en el generador del resultado, donde (en
parte por cachondo) deje en un mapa las rexp que se utilizan, por lo que la
columna de exmpresiones en la tabla se ordena al &ldquo;azar&rdquo;</p>

<p>de momento conforme con el resustado estoy y no tengo prisa por modificarlo en
el futuro cercano, mucho tiempo y dedicacion requiere para hacerlo mas &ldquo;pro&rdquo;,
como de bash y make, no controlo mucho seguro lo encontraran pobre, se aceptan
<em>pull request</em></p>

<p>el repositorio contaba con una traduccion al español, con lo cual sumaban tres
versiones de lo mismo (readme.hmtl, readme.org y readme-es.org), sumando esto
con las cuatro versiones de la libreria raptor y sus correspondientes dos
readmes, cada uno con una copia de la tabla de resultados y como no es un
proceso que hubiera automatizado, me carge el readme en español, de este repo,
mucho tiempo requeria mantenerlo a mano, deberia recapacitar aceptando las
virtudes de bash</p>

<p>para finalizar, por el camino encontre varias maneras de hacer un benchmark en
Go, ya lo contare (o no) en otro post, oooohhh como nuevo proyecto la proxima
mision es investigar en las entrañas de la libreria estandar de GO <code>&quot;regexp&quot;</code> e
incorporar algunos de sus obsenos trucoso para alcanzar una velocidad abrumadora
en texto simple, morir de lentitud en expresiones igualmente simples y ser
estandar en el resto, espero no terminar frustrado</p>


  <div class="clear" class="center">
    
    <a class="previous" href="https://www.nasciiboy.land/prog/stylus-black-translator/">◀ stylus black-translator</a>
    
    
    <a class="next" href="https://www.nasciiboy.land/prog/ischeme/"> iScheme ▶</a>
    
  </div>


  <div class="clear" ><a href="https://www.nasciiboy.land">/</a></span> <span><a href="https://www.nasciiboy.land/prog">prog</a></div>
</main>

    <aside>
      
      <section class="sidebar">
        <header class="key"><b>CATEGORIES</b></header>
        <div>
          <ul class="terms">
            <li><a href="https://www.nasciiboy.land/categories/prog">prog(48)</a></li><li><a href="https://www.nasciiboy.land/categories/post">post(37)</a></li><li><a href="https://www.nasciiboy.land/categories/emacs">emacs(14)</a></li><li><a href="https://www.nasciiboy.land/categories/apt">apt(5)</a></li><li><a href="https://www.nasciiboy.land/categories/vg">vg(5)</a></li><li><a href="https://www.nasciiboy.land/categories/love2d">love2d(1)</a></li>
          </ul>
        </div>
      </section>
      
      <section class="sidebar">
        <header class="key"><b>TAGS</b></header>
        <div>
          <ul class="terms">
            <li><a href="https://www.nasciiboy.land/tags/fonos">fonos(22)</a></li><li><a href="https://www.nasciiboy.land/tags/howto">howto(19)</a></li><li><a href="https://www.nasciiboy.land/tags/ramen">ramen(18)</a></li><li><a href="https://www.nasciiboy.land/tags/4k">4k(16)</a></li><li><a href="https://www.nasciiboy.land/tags/morg">morg(14)</a></li><li><a href="https://www.nasciiboy.land/tags/regexp">regexp(8)</a></li><li><a href="https://www.nasciiboy.land/tags/apt">apt(7)</a></li><li><a href="https://www.nasciiboy.land/tags/txt">txt(6)</a></li><li><a href="https://www.nasciiboy.land/tags/install">install(5)</a></li><li><a href="https://www.nasciiboy.land/tags/anime">anime(4)</a></li><li><a href="https://www.nasciiboy.land/tags/docu">docu(3)</a></li><li><a href="https://www.nasciiboy.land/tags/go">go(3)</a></li><li><a href="https://www.nasciiboy.land/tags/java">java(3)</a></li><li><a href="https://www.nasciiboy.land/tags/sicp">sicp(3)</a></li><li><a href="https://www.nasciiboy.land/tags/asm">asm(2)</a></li><li><a href="https://www.nasciiboy.land/tags/gnome">gnome(2)</a></li><li><a href="https://www.nasciiboy.land/tags/hardware">hardware(2)</a></li><li><a href="https://www.nasciiboy.land/tags/ncurses">ncurses(2)</a></li><li><a href="https://www.nasciiboy.land/tags/rss">rss(2)</a></li><li><a href="https://www.nasciiboy.land/tags/trl">trl(2)</a></li><li><a href="https://www.nasciiboy.land/tags/adb">adb(1)</a></li><li><a href="https://www.nasciiboy.land/tags/ag">ag(1)</a></li><li><a href="https://www.nasciiboy.land/tags/arduino">arduino(1)</a></li><li><a href="https://www.nasciiboy.land/tags/elfeed">elfeed(1)</a></li><li><a href="https://www.nasciiboy.land/tags/elisp">elisp(1)</a></li><li><a href="https://www.nasciiboy.land/tags/eww">eww(1)</a></li><li><a href="https://www.nasciiboy.land/tags/fastboot">fastboot(1)</a></li><li><a href="https://www.nasciiboy.land/tags/fish">fish(1)</a></li><li><a href="https://www.nasciiboy.land/tags/flac">flac(1)</a></li><li><a href="https://www.nasciiboy.land/tags/ibniz">ibniz(1)</a></li><li><a href="https://www.nasciiboy.land/tags/lxde">lxde(1)</a></li><li><a href="https://www.nasciiboy.land/tags/manga">manga(1)</a></li><li><a href="https://www.nasciiboy.land/tags/moc">moc(1)</a></li><li><a href="https://www.nasciiboy.land/tags/nxengine">nxengine(1)</a></li><li><a href="https://www.nasciiboy.land/tags/pobreotaku">pobreotaku(1)</a></li><li><a href="https://www.nasciiboy.land/tags/prog">prog(1)</a></li><li><a href="https://www.nasciiboy.land/tags/racer">racer(1)</a></li><li><a href="https://www.nasciiboy.land/tags/scheme">scheme(1)</a></li><li><a href="https://www.nasciiboy.land/tags/shntool">shntool(1)</a></li><li><a href="https://www.nasciiboy.land/tags/solarus">solarus(1)</a></li><li><a href="https://www.nasciiboy.land/tags/zelda">zelda(1)</a></li><li><a href="https://www.nasciiboy.land/tags/zero">zero(1)</a></li>
          </ul>
        </div>
      </section>
      
    </aside>
    <footer>
  <p>Licence: <em>GFDL 1.3</em>.
          Powered by <a href="https://gohugo.io/">Hugo</a>.

 Contact <a href="mailto:nasciiboy@gmail.com">nasciiboy@gmail.com</a><b>.
<b> GPG <a href="http://pgp.mit.edu/pks/lookup?op=get&amp;search=0x7A4E2DDE14D7AD94">0x7A4E2DDE14D7AD94</a><b>.
<b> Donar <a href="https://liberapay.com/nasciiboy/donate">liberapay</a><b>.



</p>
</footer>

  </body>
</html>
