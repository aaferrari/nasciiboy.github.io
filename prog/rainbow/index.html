<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Crear una paleta de color con solo un indice</title>
    <link href="" rel="alternate" title="nba - GNU&#39;s Rock" type="application/atom+xml">
    <style>:root {

    --BGC      : #000000;
    --FGC      : #ffffff;
    --BGClogo  : #222222;
    --FGClogo  : #ffffff;
    --FGCtitle : #ff4500;
    --FGCstart1: #4B99D2;
    --FGCstart2: #00ffff;
    --FGCstart3: #ffa074;
    --FGCstart4: #98fb98;
    --FGCstart5: #b0c4de;
    --FGCstart6: #7fffd4;
    --FGCstart7: #db2e24;
    --FGCstart8: #ff4500;
    --FGCtext  : #ffffff;
    --FGCemph  : #ffffff;
    --FGCbtcode: #333333;
    --FGCftcode: #ffffff;
    --FGCbcode : #b3b3b3;
    --FGCtcomm : #ff4500;
    --FGCtcode : #bfbfff;
    --FGCfile  : #eedd82;
    --FGCmath  : #98fb98;
    --FGClink  : #00ffff;
    --BGClinkh : #556b2f;
    --FGClinkh : #ffffff;
    --BGCdt    : #b3b3b3;
    --FGCdt    : #ffffff;
    --FGCthead : #ff7f24;
    --BGCthead : #000000;
    --FGCtbody : #87cefa;
}

@font-face { font-family: text;           src: local('sans-serif'          );                     }
@font-face { font-family: text_bold;      src: local('sans-serif'   ); font-style: bold;   }
@font-face { font-family: text_italic;    src: local('sans-serif'   ); font-style: italic; }
@font-face { font-family: text_verse;     src: local('sans-serif'   ); font-style: italic; }
@font-face { font-family: title;          src: local('cursive'      );                     }
@font-face { font-family: heatline;       src: local('cursive'      );                     }
@font-face { font-family: codetext;       src: url('http://nasciiboy.github.io/DejaVuSansMono.ttf'); }
@font-face { font-family: codeblock;      src: url('http://nasciiboy.github.io/DejaVuSansMono.ttf'); }
@font-face { font-family: description_dt; src: local('cursive'      );                     }
@font-face { font-family: description_dd; src: local('sans'         );                     }

html { background: var( --BGC ); color: var( --FGC );
       margin: 0; padding: 0;
       font-size: 1.3em;
       line-height: 1.5em;
       box-sizing: border-box;
     }

html body { margin: 1em 0em 1em 1em;
            font-size: 1.0em;
            font-family: text;
          }

html body main {font-size: 1.0em;
                font-family: text;
                box-sizing:border-box;
                padding: 1em 1em 1em 1.5em
                ;
                width: 70%;
                float: left;
               }

html body main article { padding-right: 1em; }

html body main div.thumb {font-size: 1.0em;
                font-family: text;
                box-sizing: border-box;
                padding: 1em;
                width: 48%;
                float: left;
               }

ul.meta { list-style: none; padding-left: 0.8em; margin: 0em; }
ul.meta li { line-height: 1.5em; }

.taxonomies { color: green; clear: both; }

.summary {
  max-height: 8.7rem;
  overflow: hidden;
}

div.thumb-sm {font-size: 0.7em;
                font-family: text;
             }

.thumb-sm header h2 { margin: 0em; padding: 0.3em 0em 0em 0em; }

html body aside {
    font-size: 1.0em;
    font-family: text;
    box-sizing:border-box;
    width: 30%;
    float: left;
    padding-left: 1em;
}

header.key { color: black; }

aside div ul { padding-left: 0em; margin: 0em; }

html body footer {
    font-size: 0.7em;
    clear: both;
}

nav.p-paging { clear: both; padding-top: 2em; text-align: center; }

.footer-title { clear: both; }

.footer-title a { list-style: none; text-decoration: none; color: red; }

h1 { color: var( --FGCtitle  ); font-size:   3em; font-family: title   ; line-height: 1.1em; }
h2 { color: var( --FGCstart1 ); font-size: 1.6em; font-family: heatline; line-height: 1.1em; }
h3 { color: var( --FGCstart2 ); font-size: 1.5em; font-family: heatline; line-height: 1.1em; }
h4 { color: var( --FGCstart3 ); font-size: 1.4em; font-family: heatline; line-height: 1.1em; }
h5 { color: var( --FGCstart4 ); font-size: 1.3em; font-family: heatline; line-height: 1.1em; }
h6 { color: var( --FGCstart5 ); font-size: 1.2em; font-family: heatline; line-height: 1.1em; }
h7 { color: var( --FGCstart6 ); font-size: 1.1em; font-family: heatline; line-height: 1.1em; }
h8 { color: var( --FGCstart7 ); font-size: 1.1em; font-family: heatline; line-height: 1.1em; }
h9 { color: var( --FGCstart8 ); font-size: 1.1em; font-family: heatline; line-height: 1.1em; }

.path li { display: inline; list-style:none; padding: 0em 0.1em; margin:0em; }
.path li a { text-decoration: none; color: #87cefa; }
.path-pwd { color: yellow; }

pre {
    background-color: var( --FGCbtcode ); color: white;
    font-size: 100%; text-align: left; font-family: codeblock;
    box-sizing:border-box; padding: 1.0em; border: 0.05em solid #ddd;
    overflow: auto;
}

pre code { background-color: var( --FGCbtcode ); color: var( --FGCftcode ); font-size: 1em;  font-family: codetext;
}

ul.nav { list-style-type: none; }
ul.nav li { display: inline-block; list-style: none; }
ul.nav li a { color: white; background-color: black; text-decoration: none; padding: 0.5em .5em; border: 3px solid white; }
ul.nav li a:hover { color: #ea316e; background-color: white; text-decoration: none; padding: 0.2em .5em; border-radius: 1em; }


b    { font-family: text_bold; }
i    { font-family: text_italic; }
u    { text-decoration: underline; }
em   { color: var( --FGCemph ); font-weight: 600; }
code { color: var( --FGCtcode ); font-family: codetext; padding: 0px 0.2em; }
code.command { color: var( --FGCtcomm ); font-family: codetext; padding: 0px 0.2em; }
.file { color: var( --FGCfile ); font-family: codetext; }
.math { color: var( --FGCmath ); font-family: codetext; }

a { color: #00ffff; text-decoration: underline; }
a:hover { background-color: #556b2f; color: #ffffff; text-decoration: none; }

li { color: #fff; font-size: 1em; }
li b { font-weight: bold; }
li p { color: #fff; font-size: 1em; }


dl { padding-bottom: 2em; }
dl dt { color: #daa520;
                                  font-size: 1.2em; font-family: description_dt;
                                  margin-left: 0.6em; }
dd { color: #ffffff;
                                  font-size: 1.0em; font-family: description_dd; font-style: bold;
                                  margin-left: 0.6em; }
img { border: none; max-width: 100%;
    }
img:hover { border: 0.05em solid #fff; }

.clear  { clear: both; }
.center { display: flex;
          justify-content: center;
        }
.previous { float: left; }
.next { float: right; }
</style>
  </head>
  <body>
    
<main>
  <div class="clear" ><a href="http://nasciiboy.github.io">/</a></span> <span><a href="http://nasciiboy.github.io/prog">prog</a></div>

  <h1>Crear una paleta de color con solo un indice</h1>
  

<p><img src="http://nasciiboy.github.io/img/mandelbrot.png" alt="" /></p>

<p>que tal, como lo indica el titulo vamos a generar una paleta de color apartir de
un unico indice, para, por ejemplo colorear una imagen en una escala de
colores RGB del negro absoluto (0,0,0) al blanco (255,255,255), con una
trancicion &ldquo;suave&rdquo; por estos</p>

<p>El asunto surgio resolviendo algunos de los ejercicios de libro de programacion
de go, especificamente el 3.5, donde proponian dar color a una imagen de
mandelbrot, que estaba en una escala de grises (de hay viene lo de generar los
colores apartir de un solo indice).</p>

<p>La primer y mas facil solucion es utilizar una paleta de colores prefabricada y
adaptar el indice a un valor que entre en la paleta, pero eso es muy cutre, lo mas molon
seria generar el color &ldquo;al vuelo&rdquo; de una paleta con un numero de colores
arbitrario, yeee!</p>

<p>entonces, como se hace? bueno&hellip; tenia una idea con un circulo de color,
una espiral, y longitudes, pero como las mates no son lo mio, le pregunte a la gente de <a href="https://www.reddit.com/r/programacion/comments/6g28j9/generar_paleta_de_colores_con_solo_un_indice/">internet</a>
(mejor explicado <a href="https://www.reddit.com/r/Matematicas/comments/6g5f22/recorrido_atravez_de_un_circulo_de_color_rgb/">aca</a>)</p>

<p>y luego? pues, no llego la respuesta matematica que esperaba, peeeeeero una
respuesta me dio a conocer dos modelos de color, como los que utilzaban las
teles crt de la antiguedad</p>

<h2 id="modelo-de-color-hsl">Modelo de color HSL</h2>

<p><a href="https://es.wikipedia.org/wiki/Modelo_de_color_HSL">https://es.wikipedia.org/wiki/Modelo_de_color_HSL</a></p>

<p><img src="http://nasciiboy.github.io/img/HSL.png" alt="" /></p>

<p>como podemos ver, tenemos tres valores, <strong>luminosidad</strong>, <strong>saturacion</strong> y
<strong>matiz</strong>, con la particularidad que el color inicia en negro absoluto y luego
converge en blanco, y los colores puros (del esquema RGB, cuando uno de ellos es
255 y los otros dos 0) se optienen con la luminosidad a la mitad de su valor y
la saturcion al maximo, ahora, si la luminosidad esta al maximo, terminaremos
con un color blanco, independientemente de saturacion y matiz, lo mismo en caso
contrario, es decir, si la luminocidad al minimo dara el color negro</p>

<p>estas particulares hacen a este modelo mucho mas intuitivo que el clasico modelo
RGB, ademas de practico para optener tranciciones suaves, especiarmente para el
caso de generar una paleta variada</p>

<p>supondre que su popularidad no esta lo suficientemente extendida en el campo
programacional por requerir un calculo considerablemente mayor</p>

<h2 id="modelo-de-color-hsv">Modelo de color HSV</h2>

<p><a href="https://es.wikipedia.org/wiki/Modelo_de_color_HSV">https://es.wikipedia.org/wiki/Modelo_de_color_HSV</a></p>

<p>En este modelo, los colores alcanzan su maximo valor de iluminacion con el valor
maximo de luminocidad, sin embargo y adiferencia de HSL este se decanta por un
color u otro segun la
saturacion y matiz</p>

<p><img src="http://nasciiboy.github.io/img/HSV.png" alt="" /></p>

<h2 id="codigo">Codigo</h2>

<p>De entre los dos Modelos de color, escogi HSL, pues se realiza la trancicion del
negro al blanco y con HSV la trancicion culminaria en un color especifico (si
desea seguir este ultimo esquema, lo ideal seria generar distintos matizes con
niveles de saturacion especificos, realizando un bucle por la luminocidad)</p>

<p>aqui esta el codigo para optener un color dentro de nuestra paleta de colores</p>

<pre><code>package color

const colors = 255             // colores disponibles
const secs   = 3               // seciones de color
const sec    = colors / secs   // longitud de seccion

func MagicColor( x, scale int ) (r, g, b uint8) {
  color := int(x * colors / scale)

  h := float64(color % sec) / sec
  s := 1.0
  l := float64(color) / colors

  return hsl2rgb( h, s, l )
}

func hsl2rgb( h, s, l float64 ) (red, green, blue uint8) {
  r, g, b := l, l, l

  var v float64

  if l &lt;= 0.5 {
    v = l * (1.0 + s)
  } else {
    v = l + s - l * s
  }

  if v &gt; 0 {
    m  := l + l - v
    sv := (v - m) / v
    h  *= 6.0
    sextant := int(h)
    fract := h - float64(sextant)
    vsf   := v * sv * fract
    mid1 := m + vsf
    mid2 := v - vsf

    switch sextant {
    case 0: r, g, b = v, mid1, m
    case 1: r, g, b = mid2, v, m
    case 2: r, g, b = m, v, mid1
    case 3: r, g, b = m, mid2, v
    case 4: r, g, b = mid1, m, v
    case 5: r, g, b = v, m, mid2
    }
  }

  red, green, blue = uint8(r * 255.0), uint8(g * 255.0), uint8(b * 255.0)
  return
}
</code></pre>

<p>debo aclarar que pese a que funciona segun lo planeado, los algoritmos para
convertir de HSL (y HSV) a rgb los traduje de codigo de internete, desconosco si
pueda hacerse mejor, por que no entiendo &ldquo;las formulas&rdquo; que proporciona la wikipedia</p>

<p>vamos con la explicacion (de lo que entiendo), primero la funcion de cara al
publico, es <code>MagicColor</code> que recive el indice, y el valor maximo que este puede
alcanzar (suprimir este ultimo si se conoce de antemano o mejor aun, que la
paleta tenga tantos colores como el valor maximo, no hice esto por pereza y por
que las constantes en Go son &ldquo;magicas&rdquo; y no requieren de estupidos cast y se
pueden utilizar tanto para enteros, como flotantes, como <strong>racionales</strong>(?que es
esto?))</p>

<p>la constante <code>colors</code> establece el numero de colores que tendra la paleta,
<code>secs</code> es el numero de &ldquo;tranciciones&rdquo; atraves del matiz (<code>h</code>) es decir,
partiendo de color rojo, pasamos por el verde y luego azul para terminar de
nuevo en rojo. Si tenemos solo una transicion/seccion/ciclo digamos que nos
movemos en espiral (ver dibujo HSL) negro-rojo-verde-azul-rojo-blanco si tenemos mas
de un ciclo seria negro - <strong>(rojo-verde-azul)</strong> - blanco, donde la region
<strong>(rojo-verde-azul)</strong>  se repite una y otra vez, con variaciones de luminocidad</p>

<p>por ultimo establesco el nivel de saturacion al maximo (<code>1.0</code>, la variables de
hsl2rgb y hsv2rgb van de 0.0 a 1.0)</p>

<p>aqui esta la vercion hsv2rgb, pero como antes mencione, debemos tomar un enfoque
distinto en MagicColor, para que la paleta tenga una variedad logica, primero un
ciclo por la luminocidad, y dentro de este un ciclo por saturacion y matiz, no hice
eso, asi que vas por cuenta propia, aunque tampoco es muy complicado</p>

<p>(Nota: agregar <code>import &quot;math&quot;</code> luego de la declaracion <code>package color</code>)</p>

<pre><code>func hsv2rgb( h, s, v float64 ) (red, green, blue uint8) {
  var r, g, b float64

  i := int(math.Floor(h * 6))
  f := h * 6 - float64(i);
  p := v * (1 - s);
  q := v * (1 - f * s);
  t := v * (1 - (1 - f) * s);

  switch i % 6 {
  case 0: r, g, b = v, t, p
  case 1: r, g, b = q, v, p
  case 2: r, g, b = p, v, t
  case 3: r, g, b = p, q, v
  case 4: r, g, b = t, p, v
  case 5: r, g, b = v, p, q
  }

  red, green, blue = uint8(r * 255.0), uint8(g * 255.0), uint8(b * 255.0)
  return
}
</code></pre>

<p>puedes copiar el codigo y ponerlo en un fichero (digamos en <code>~/color/color.go</code>), y
hacer pruebas con lo siguiente (poner en <code>~/main.go</code>)</p>

<pre><code>package main

import (
  &quot;fmt&quot;
  &quot;./color&quot;
)

func main(){
  fmt.Printf( `&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot;
&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; lang=&quot;&quot; xml:lang=&quot;&quot; &gt;

  &lt;body&gt;
` )

  for i := 0; i &lt; 255; i++ {
    r, g, b := color.MagicColor( i, 255 )
    var c int32
    c = int32(r) &lt;&lt; 16 | int32(g) &lt;&lt; 8 | int32(b)

    fmt.Printf( &quot;&lt;span style=\&quot;color:#%06x;\&quot; &gt;a&lt;/span&gt;&quot;, c )
  }
  fmt.Println( &quot;&lt;/body&gt;&lt;/html&gt;&quot; )
}
</code></pre>

<p>ir a nuestro <code>~</code> y ejecutar con <code>go run main.go &gt; prueba.html</code>, abrimos
<code>prueba.html</code> con nuestro flamante navegador y veremos una fila de <code>a</code>s en
escala de colores!</p>

<p>para terminar, <a href="https://raw.githubusercontent.com/nasciiboy/TGPL-Exercises/master/03-05/nasciiboy/main.go">aca</a> esta
la solucion al ejercicio que motivo este post</p>

<p>descargar y ejecutar con</p>

<pre><code class="language-sh">cd 'directorio-de-descarga'

# para imagen mandelbrot
go run main.go &gt; mandelbrot.png

# o

go run main.go -t m &gt; mandelbrot.png

# para imagen newton
go run main.go -t n &gt; newton.png

# para imagen sqrt
go run main.go -t s &gt; sqrt.png

# para imagen acos
go run main.go -t a &gt; acos.png
</code></pre>

<p>la imagen generada con mandelbrot es muy triste, en cambio con el algoritmo
newton es distinto:</p>

<p>algoritmo newton con <code>secs</code> establecido en 1 (un ciclo)</p>

<p><img src="http://nasciiboy.github.io/img/newton.png" alt="" /></p>

<p>algoritmo newton con <code>secs</code> establecido en 2 (dos ciclos)</p>

<p><img src="http://nasciiboy.github.io/img/newton2.png" alt="" /></p>

<p>algoritmo newton con <code>secs</code> establecido en 50 y <code>colors</code> en 5000</p>

<p><img src="http://nasciiboy.github.io/img/newton3.png" alt="" /></p>

<p>para los algoritmos <code>acos</code> y <code>sqrt</code> no interviene nuestro <code>MagicColors</code>, aun asi
la salida es bastante chula</p>

<p>Happy Hacking!</p>


  <div class="clear" class="center">
    
    <a class="previous" href="http://nasciiboy.github.io/prog/tgpl/">◀ El Lenguaje De programacion Go</a>
    
    
    <a class="next" href="http://nasciiboy.github.io/prog/morg-d432/"> morg [dia 432] ▶</a>
    
  </div>

  <div class="clear" ><a href="http://nasciiboy.github.io">/</a></span> <span><a href="http://nasciiboy.github.io/prog">prog</a></div>
</main>

    <aside>
      
      <section class="sidebar">
        <header class="key"><b>CATEGORIES</b></header>
        <div>
          <ul class="terms">
            <li><a href="http://nasciiboy.github.io/categories/prog">prog(36)</a></li><li><a href="http://nasciiboy.github.io/categories/post">post(24)</a></li><li><a href="http://nasciiboy.github.io/categories/emacs">emacs(10)</a></li><li><a href="http://nasciiboy.github.io/categories/apt">apt(5)</a></li><li><a href="http://nasciiboy.github.io/categories/vg">vg(5)</a></li><li><a href="http://nasciiboy.github.io/categories/love2d">love2d(1)</a></li>
          </ul>
        </div>
      </section>
      
      <section class="sidebar">
        <header class="key"><b>TAGS</b></header>
        <div>
          <ul class="terms">
            <li><a href="http://nasciiboy.github.io/tags/howto">howto(15)</a></li><li><a href="http://nasciiboy.github.io/tags/ramen">ramen(15)</a></li><li><a href="http://nasciiboy.github.io/tags/fonos">fonos(14)</a></li><li><a href="http://nasciiboy.github.io/tags/morg">morg(12)</a></li><li><a href="http://nasciiboy.github.io/tags/4k">4k(8)</a></li><li><a href="http://nasciiboy.github.io/tags/apt">apt(7)</a></li><li><a href="http://nasciiboy.github.io/tags/regexp">regexp(7)</a></li><li><a href="http://nasciiboy.github.io/tags/install">install(5)</a></li><li><a href="http://nasciiboy.github.io/tags/anime">anime(4)</a></li><li><a href="http://nasciiboy.github.io/tags/docu">docu(3)</a></li><li><a href="http://nasciiboy.github.io/tags/java">java(3)</a></li><li><a href="http://nasciiboy.github.io/tags/sicp">sicp(3)</a></li><li><a href="http://nasciiboy.github.io/tags/gnome">gnome(2)</a></li><li><a href="http://nasciiboy.github.io/tags/go">go(2)</a></li><li><a href="http://nasciiboy.github.io/tags/ncurses">ncurses(2)</a></li><li><a href="http://nasciiboy.github.io/tags/rss">rss(2)</a></li><li><a href="http://nasciiboy.github.io/tags/adb">adb(1)</a></li><li><a href="http://nasciiboy.github.io/tags/elfeed">elfeed(1)</a></li><li><a href="http://nasciiboy.github.io/tags/eww">eww(1)</a></li><li><a href="http://nasciiboy.github.io/tags/fastboot">fastboot(1)</a></li><li><a href="http://nasciiboy.github.io/tags/fish">fish(1)</a></li><li><a href="http://nasciiboy.github.io/tags/flac">flac(1)</a></li><li><a href="http://nasciiboy.github.io/tags/ibniz">ibniz(1)</a></li><li><a href="http://nasciiboy.github.io/tags/lxde">lxde(1)</a></li><li><a href="http://nasciiboy.github.io/tags/manga">manga(1)</a></li><li><a href="http://nasciiboy.github.io/tags/moc">moc(1)</a></li><li><a href="http://nasciiboy.github.io/tags/nxengine">nxengine(1)</a></li><li><a href="http://nasciiboy.github.io/tags/racer">racer(1)</a></li><li><a href="http://nasciiboy.github.io/tags/scheme">scheme(1)</a></li><li><a href="http://nasciiboy.github.io/tags/shntool">shntool(1)</a></li><li><a href="http://nasciiboy.github.io/tags/solarus">solarus(1)</a></li><li><a href="http://nasciiboy.github.io/tags/txt">txt(1)</a></li><li><a href="http://nasciiboy.github.io/tags/zelda">zelda(1)</a></li><li><a href="http://nasciiboy.github.io/tags/zero">zero(1)</a></li>
          </ul>
        </div>
      </section>
      
    </aside>
    <footer>
  <p>Licence: <em>GFDL 1.3</em>.
          Powered by <a href="https://gohugo.io/">Hugo</a>.

 Contact <a href="mailto:nasciiboy@gmail.com">nasciiboy@gmail.com</a><b>.
<b> GPG <a href="http://pgp.mit.edu/pks/lookup?op=get&amp;search=0x7A4E2DDE14D7AD94">0x7A4E2DDE14D7AD94</a><b>.
<b> Donar <a href="https://liberapay.com/nasciiboy/donate">liberapay</a><b>.



</p>
</footer>

  </body>
</html>
